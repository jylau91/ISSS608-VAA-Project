<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-06-15">

<title>Take-Home Exercise 3 ‚Äì ISSS608-VAA-Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-dfb324f25d9b1687192fa8be62ac8f9c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">ISSS608-VAA-Project</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./project_proposal.html"> 
<span class="menu-text">Project Proposal</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./Take-Home_Ex03.html" aria-current="page"> 
<span class="menu-text">Prototype</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://isss608-ay2024-25apr-jylau.shinyapps.io/DeepDiving/"> 
<span class="menu-text">üì± ShinyApp</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#prototype-isss608-take-home-exercise-3" id="toc-prototype-isss608-take-home-exercise-3" class="nav-link active" data-scroll-target="#prototype-isss608-take-home-exercise-3">Prototype (ISSS608-Take Home Exercise 3)</a></li>
  <li><a href="#interactive-exploration-of-cootefoo-bias-a-shiny-application-storyboard" id="toc-interactive-exploration-of-cootefoo-bias-a-shiny-application-storyboard" class="nav-link" data-scroll-target="#interactive-exploration-of-cootefoo-bias-a-shiny-application-storyboard">Interactive Exploration of COOTEFOO Bias: A Shiny Application Storyboard</a>
  <ul class="collapse">
  <li><a href="#background-and-context" id="toc-background-and-context" class="nav-link" data-scroll-target="#background-and-context">Background and Context</a></li>
  </ul></li>
  <li><a href="#investigative-narrative-shiny-application" id="toc-investigative-narrative-shiny-application" class="nav-link" data-scroll-target="#investigative-narrative-shiny-application">Investigative Narrative: Shiny Application</a>
  <ul class="collapse">
  <li><a href="#initial-eda" id="toc-initial-eda" class="nav-link" data-scroll-target="#initial-eda">Initial EDA</a></li>
  <li><a href="#stage-1-initial-claims---examining-individual-sources-filah-trout" id="toc-stage-1-initial-claims---examining-individual-sources-filah-trout" class="nav-link" data-scroll-target="#stage-1-initial-claims---examining-individual-sources-filah-trout">Stage 1: Initial Claims - Examining Individual Sources (FILAH &amp; TROUT)</a>
  <ul class="collapse">
  <li><a href="#visualisation" id="toc-visualisation" class="nav-link" data-scroll-target="#visualisation">Visualisation</a></li>
  <li><a href="#insights-and-links-to-next-stage" id="toc-insights-and-links-to-next-stage" class="nav-link" data-scroll-target="#insights-and-links-to-next-stage">Insights and Links to Next Stage:</a></li>
  </ul></li>
  <li><a href="#stage-2-spatial-bias---where-do-cootefoo-members-actually-go" id="toc-stage-2-spatial-bias---where-do-cootefoo-members-actually-go" class="nav-link" data-scroll-target="#stage-2-spatial-bias---where-do-cootefoo-members-actually-go">Stage 2: Spatial Bias - Where Do COOTEFOO Members Actually Go?</a>
  <ul class="collapse">
  <li><a href="#visualisation-1" id="toc-visualisation-1" class="nav-link" data-scroll-target="#visualisation-1">Visualisation</a></li>
  <li><a href="#insights-and-links-to-next-stage-1" id="toc-insights-and-links-to-next-stage-1" class="nav-link" data-scroll-target="#insights-and-links-to-next-stage-1">Insights and Links to Next Stage:</a></li>
  </ul></li>
  <li><a href="#stage-3-sentiment-analysis---quantifying-emotional-tone-and-bias" id="toc-stage-3-sentiment-analysis---quantifying-emotional-tone-and-bias" class="nav-link" data-scroll-target="#stage-3-sentiment-analysis---quantifying-emotional-tone-and-bias">Stage 3: Sentiment Analysis - Quantifying Emotional Tone and Bias</a>
  <ul class="collapse">
  <li><a href="#visualisation-2" id="toc-visualisation-2" class="nav-link" data-scroll-target="#visualisation-2">Visualisation</a></li>
  <li><a href="#insights-and-links-to-final-stage" id="toc-insights-and-links-to-final-stage" class="nav-link" data-scroll-target="#insights-and-links-to-final-stage">Insights and Links to Final Stage:</a></li>
  </ul></li>
  <li><a href="#stage-4-integrated-dashboard---deep-dive-into-individual-members-and-evidence-gaps" id="toc-stage-4-integrated-dashboard---deep-dive-into-individual-members-and-evidence-gaps" class="nav-link" data-scroll-target="#stage-4-integrated-dashboard---deep-dive-into-individual-members-and-evidence-gaps">Stage 4: Integrated Dashboard - Deep Dive into Individual Members and Evidence Gaps</a>
  <ul class="collapse">
  <li><a href="#visualisation-3" id="toc-visualisation-3" class="nav-link" data-scroll-target="#visualisation-3">Visualisation:</a></li>
  <li><a href="#illustrative-example-seal-accused-by-trout" id="toc-illustrative-example-seal-accused-by-trout" class="nav-link" data-scroll-target="#illustrative-example-seal-accused-by-trout">Illustrative Example (Seal, accused by TROUT):</a></li>
  </ul></li>
  <li><a href="#proposed-dashboard" id="toc-proposed-dashboard" class="nav-link" data-scroll-target="#proposed-dashboard">Proposed Dashboard</a></li>
  <li><a href="#dashboard-initial-data-analysis-insights" id="toc-dashboard-initial-data-analysis-insights" class="nav-link" data-scroll-target="#dashboard-initial-data-analysis-insights">Dashboard: Initial Data Analysis &amp; Insights</a></li>
  <li><a href="#dashboard-main-integrated-analysis" id="toc-dashboard-main-integrated-analysis" class="nav-link" data-scroll-target="#dashboard-main-integrated-analysis">Dashboard: Main Integrated Analysis</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Take-Home_Ex03.docx"><i class="bi bi-file-word"></i>MS Word</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-Home Exercise 3</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 15, 2025</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">July 6, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="prototype-isss608-take-home-exercise-3" class="level1">
<h1>Prototype (ISSS608-Take Home Exercise 3)</h1>
<p>Link to VAST Challenge 2025, <a href="https://vast-challenge.github.io/2025/MC2.html">Mini-Challenge 2</a>.</p>
</section>
<section id="interactive-exploration-of-cootefoo-bias-a-shiny-application-storyboard" class="level1">
<h1>Interactive Exploration of COOTEFOO Bias: A Shiny Application Storyboard</h1>
<section id="background-and-context" class="level2">
<h2 class="anchored" data-anchor-id="background-and-context">Background and Context</h2>
<p>Oceanus, a small island nation, has historically relied on a robust fishing-based economy. In recent years, however, tourism has begun rapidly expanding, significantly reshaping local economic dynamics. To guide this complex transition responsibly, the government established the <strong>Commission on Overseeing the Economic Future of Oceanus (COOTEFOO)</strong>. This appointed oversight board, while lacking direct legislative power, holds substantial influence and funding, entrusted to evaluate economic trends objectively and advise accordingly.</p>
<p>COOTEFOO‚Äôs role, however, has come under intense scrutiny. Two vocal advocacy groups have recently accused the board of deep-seated biases:</p>
<ul>
<li><p><strong>Fishing is Living and Heritage (FILAH)</strong> claims COOTEFOO is overly biased towards promoting tourism, neglecting the island‚Äôs historical economic foundation in fishing.</p></li>
<li><p>Conversely, <strong>Tourism Raises OceanUs Together (TROUT)</strong> argues COOTEFOO remains stubbornly loyal to fishing interests, effectively ignoring lucrative opportunities offered by tourism.</p></li>
</ul>
<p>In response to these competing accusations, investigative journalist <strong>Edwina Darling Moray (E.D.)</strong> of the Haacklee Herald obtained the datasets provided by both FILAH and TROUT, containing detailed meeting minutes and travel records for COOTEFOO members. Moray also secured additional evidence beyond what either advocacy group had compiled. After initial data cleaning and knowledge-graph creation by a staff programmer, these datasets were prepared for analysis.</p>
</section>
</section>
<section id="investigative-narrative-shiny-application" class="level1">
<h1>Investigative Narrative: Shiny Application</h1>
<p>The interactive Shiny visualisation tool is structured to guide Moray through four distinct yet closely connected analytical stages. Each stage builds logically upon the previous, forming a coherent investigative narrative that progressively deepens understanding and systematically evaluates accusations of bias.</p>
<section id="initial-eda" class="level2">
<h2 class="anchored" data-anchor-id="initial-eda">Initial EDA</h2>
<p><img src="images/clipboard-1783245836.png" class="img-fluid" width="568"></p>
<p>The Exploratory Data Analysis (EDA) dashboard provides an overview of sentiment and activity coverage across three datasets (FILAH, TROUT, JOURNALIST) to identify potential biases and gaps in COOTEFOO‚Äôs discussions.</p>
<p>Firstly, sentiment distributions (violin plots) show that TROUT leans positively towards tourism and has limited coverage of fishing, while FILAH presents wider sentiment variability in fishing. JOURNALIST provides a more balanced view, sitting between the two extremes.</p>
<p>Secondly, the stacked bar chart highlights clear gaps: TROUT under-represents fishing sentiment, while FILAH lacks data on other industry categories, emphasising skewed coverage.</p>
<p>Thirdly, member activity bar charts reveal uneven representation, some members, like Simone Kat, appear frequently across all datasets, whereas others, like Seal and Teddy Goldstein, have sparse coverage in FILAH or TROUT.</p>
<p>Lastly, a sentiment coverage table explicitly summarises member representation across datasets, clearly illustrating individual-level gaps. Overall, the EDA reveals dataset-specific biases, justifying deeper interactive analysis in subsequent stages.</p>
</section>
<section id="stage-1-initial-claims---examining-individual-sources-filah-trout" class="level2">
<h2 class="anchored" data-anchor-id="stage-1-initial-claims---examining-individual-sources-filah-trout">Stage 1: Initial Claims - Examining Individual Sources (FILAH &amp; TROUT)</h2>
<p>Moray‚Äôs investigation begins by evaluating the datasets from TROUT and FILAH separately. Is there intrinsic evidence of bias within each group‚Äôs own records?</p>
<section id="visualisation" class="level3">
<h3 class="anchored" data-anchor-id="visualisation">Visualisation</h3>
<p><img src="images/clipboard-1107028685.png" class="img-fluid"></p>
<p>A force-directed node-link diagram (<code>ggraph</code>) explicitly illustrates relationships among COOTEFOO members, discussion topics (fishing/tourism), and plans. Nodes and edges coloured by industry reveal patterns of engagement.</p>
<p>Interactive bar charts quantify exactly how much each member engages with fishing vs tourism topics, highlighting asymmetric attention and possible echo chambers.</p>
<p><strong>Sidebar Controls</strong></p>
<p><strong>Choose dataset:</strong></p>
<ul>
<li><p>Toggles which advocacy group‚Äôs data you‚Äôre exploring.</p></li>
<li><p>FILAH shows the ‚ÄúFishing Is Living and Heritage‚Äù graph, TROUT would swap in ‚ÄúTourism Raises OceanUs Together.‚Äù</p></li>
</ul>
<p><strong>Show plan nodes:</strong></p>
<ul>
<li><p>When checked, you see <strong>golden-rod diamonds</strong> representing individual policy or action plans discussed by members.</p></li>
<li><p>Unchecking hides those diamonds so you focus purely on member‚Äìtopic links.</p></li>
</ul>
<p><strong>Minimum topic degree (slider = 1):</strong></p>
<ul>
<li><p>Filters out topics with fewer than <em>n</em> member connections.</p></li>
<li><p>At ‚Äú1,‚Äù all topics appear. Sliding up to, say, ‚Äú3‚Äù would remove topics discussed by fewer than three members, decluttering the graph.</p></li>
</ul>
</section>
<section id="insights-and-links-to-next-stage" class="level3">
<h3 class="anchored" data-anchor-id="insights-and-links-to-next-stage">Insights and Links to Next Stage:</h3>
<p>Through this visualisation, Moray explicitly identifies preliminary biases. Members notably skewed toward one industry become focal points in subsequent analyses. The biases identified here set expectations for travel patterns explored in Stage 2, allowing Moray to test whether members‚Äô stated interests match their real-world actions.</p>
</section>
</section>
<section id="stage-2-spatial-bias---where-do-cootefoo-members-actually-go" class="level2">
<h2 class="anchored" data-anchor-id="stage-2-spatial-bias---where-do-cootefoo-members-actually-go">Stage 2: Spatial Bias - Where Do COOTEFOO Members Actually Go?</h2>
<p>Having identified initial biases in member engagement, Moray next integrates all available records (FILAH, TROUT, additional data) to examine COOTEFOO‚Äôs official travel activities. Do their physical travels reinforce or contradict biases observed in Stage 1?</p>
<section id="visualisation-1" class="level3">
<h3 class="anchored" data-anchor-id="visualisation-1">Visualisation</h3>
<p><img src="images/clipboard-3412977907.png" class="img-fluid"></p>
<p>An interactive map (<code>leaflet</code>) clearly displays official COOTEFOO travel locations, explicitly marking fishing-related visits (blue markers) versus tourism-related visits (orange markers).</p>
<p>DBSCAN clusters explicitly identify spatial ‚Äúecho chambers‚Äù or regions consistently favoured, coloured and labelled by industry type.</p>
<p>An accompanying interactive stacked bar chart summarises trips per member by industry, explicitly linking real-world actions to biases identified in Stage 1.</p>
</section>
<section id="insights-and-links-to-next-stage-1" class="level3">
<h3 class="anchored" data-anchor-id="insights-and-links-to-next-stage-1">Insights and Links to Next Stage:</h3>
<p>Moray explicitly compares observed travel behaviour against initial engagement biases. Spatial clusters reinforce or challenge perceived biases from discussions, preparing Moray to further quantify the emotional and ideological tone behind these activities in Stage 3.</p>
</section>
</section>
<section id="stage-3-sentiment-analysis---quantifying-emotional-tone-and-bias" class="level2">
<h2 class="anchored" data-anchor-id="stage-3-sentiment-analysis---quantifying-emotional-tone-and-bias">Stage 3: Sentiment Analysis - Quantifying Emotional Tone and Bias</h2>
<p>With clear insights into engagement and travel, Moray now examines the underlying emotional tone of COOTEFOO members‚Äô recorded comments across the fishing and tourism contexts. Critically, Moray needs to understand how missing records from FILAH and TROUT distort or shift perceptions when compared with the combined complete dataset.</p>
<section id="visualisation-2" class="level3">
<h3 class="anchored" data-anchor-id="visualisation-2">Visualisation</h3>
<p><img src="images/clipboard-1557551836.png" class="img-fluid">Three interactive sentiment heatmaps (<code>plotly</code>) explicitly compare average sentiment (negative to positive) for each member across FILAH, TROUT, and the comprehensive combined dataset.</p>
<p>Interactive drill-down capabilities let Moray explicitly explore detailed comments underpinning sentiment scores, providing transparency and context.</p>
<p>Delta bars explicitly quantify changes in sentiment scores when merging additional data, indicating whether initial accusations from TROUT and FILAH become strengthened, weakened, or unchanged.</p>
</section>
<section id="insights-and-links-to-final-stage" class="level3">
<h3 class="anchored" data-anchor-id="insights-and-links-to-final-stage">Insights and Links to Final Stage:</h3>
<p>This sentiment analysis explicitly reveals how initial biases from incomplete datasets are reshaped by comprehensive evidence. Members experiencing significant sentiment shifts become key figures in the detailed personal investigations undertaken in Stage 4.</p>
</section>
</section>
<section id="stage-4-integrated-dashboard---deep-dive-into-individual-members-and-evidence-gaps" class="level2">
<h2 class="anchored" data-anchor-id="stage-4-integrated-dashboard---deep-dive-into-individual-members-and-evidence-gaps">Stage 4: Integrated Dashboard - Deep Dive into Individual Members and Evidence Gaps</h2>
<p>Finally, Moray needs precise, personalised analysis, clearly seeing how specific members‚Äô reputations are influenced by missing or incomplete evidence. The integrated dashboard consolidates insights from previous stages, explicitly highlighting how datasets from TROUT and FILAH distorted perceptions.</p>
<section id="visualisation-3" class="level3">
<h3 class="anchored" data-anchor-id="visualisation-3">Visualisation:</h3>
<p><img src="images/clipboard-4221546058.png" class="img-fluid"></p>
<p>An integrated, interactive dashboard explicitly combines network engagement (Stage 1), travel locations (Stage 2), and sentiment (Stage 3) into a cohesive investigative tool.</p>
<p>Moray selects any COOTEFOO member (defaulting explicitly to one TROUT-accused member, e.g., Seal) to synchronously update visualisations:</p>
<p>Ego-centric network graph explicitly visualises relationships and missing evidence.</p>
<p>Interactive map explicitly shows detailed travel history, highlighting trips missing from individual advocacy datasets.</p>
<p>Sentiment heat-bar explicitly illustrates sentiment shifts between datasets, clearly quantifying bias distortions.</p>
<p>Detailed evidence tables explicitly list exact records (plans, discussions, trips) omitted from TROUT/FILAH, clearly revealing critical missing evidence that significantly impacts judgements.</p>
</section>
<section id="illustrative-example-seal-accused-by-trout" class="level3">
<h3 class="anchored" data-anchor-id="illustrative-example-seal-accused-by-trout">Illustrative Example (Seal, accused by TROUT):</h3>
<p>Moray explicitly observes how TROUT‚Äôs incomplete evidence falsely portrays Seal as neutral. The combined data clearly reveals significant additional tourism-related activities and positive sentiment, explicitly undermining TROUT‚Äôs accusation and demonstrating precisely how missing records distort the narrative.</p>
<p><img src="images/clipboard-3028370409.png" class="img-fluid"></p>
</section>
</section>
<section id="proposed-dashboard" class="level2">
<h2 class="anchored" data-anchor-id="proposed-dashboard">Proposed Dashboard</h2>
<div class="cell">
<details class="code-fold">
<summary>Skeleton Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shinydashboard)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visNetwork)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Load datasets (replace with actual paths or reactiveFileReader for large files)</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>datasets <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"TROUT"</span> <span class="ot">=</span> <span class="fu">fromJSON</span>(<span class="st">"TROUT.json"</span>, <span class="at">flatten =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"FILAH"</span> <span class="ot">=</span> <span class="fu">fromJSON</span>(<span class="st">"FILAH.json"</span>, <span class="at">flatten =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Journalist"</span> <span class="ot">=</span> <span class="fu">fromJSON</span>(<span class="st">"journalist.json"</span>, <span class="at">flatten =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Classify topic labels into industries</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>classify_industry_from_label <span class="ot">&lt;-</span> <span class="cf">function</span>(label) {</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">str_detect</span>(label, <span class="fu">regex</span>(<span class="st">"fish|dock|crane|vacuum|seafood|harbor|inspection"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>))) {</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Fishing"</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">str_detect</span>(label, <span class="fu">regex</span>(<span class="st">"tourist|statue|park|festival|concert|market|heritage"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>))) {</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Tourism"</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Other"</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">dashboardPage</span>(</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dashboardHeader</span>(<span class="at">title =</span> <span class="fu">span</span>(<span class="st">"Oceanus Analysis Dashboard"</span>, <span class="at">style =</span> <span class="st">"font-size: 20px;"</span>)),</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dashboardSidebar</span>(</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sidebarMenu</span>(</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">menuItem</span>(<span class="st">"Data Analysis &amp; Insights"</span>, <span class="at">tabName =</span> <span class="st">"insights"</span>, <span class="at">icon =</span> <span class="fu">icon</span>(<span class="st">"chart-bar"</span>)),</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">menuItem</span>(<span class="st">"Dashboard"</span>, <span class="at">tabName =</span> <span class="st">"dashboard"</span>, <span class="at">icon =</span> <span class="fu">icon</span>(<span class="st">"tachometer-alt"</span>)),</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">checkboxGroupInput</span>(<span class="st">"selected_datasets"</span>, <span class="st">"Datasets (3 data sets) - multi select:"</span>, </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>                         <span class="at">choices =</span> <span class="fu">names</span>(datasets), <span class="at">selected =</span> <span class="fu">names</span>(datasets)),</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">uiOutput</span>(<span class="st">"industry_ui"</span>),</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">uiOutput</span>(<span class="st">"member_ui"</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dashboardBody</span>(</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    tags<span class="sc">$</span><span class="fu">head</span>(tags<span class="sc">$</span><span class="fu">style</span>(<span class="fu">HTML</span>(<span class="st">".content-wrapper { overflow-x: scroll; }"</span>))),</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabItems</span>(</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tabItem</span>(<span class="at">tabName =</span> <span class="st">"insights"</span>,</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>              <span class="fu">fluidPage</span>(</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>                <span class="fu">h2</span>(<span class="st">"Data Analysis &amp; Insights"</span>),</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>                <span class="fu">fluidRow</span>(</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">box</span>(<span class="at">title =</span> <span class="st">"Member Participation Count"</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">600</span>, <span class="fu">plotOutput</span>(<span class="st">"participation_plot"</span>, <span class="at">height =</span> <span class="dv">550</span>)),</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">box</span>(<span class="at">title =</span> <span class="st">"Distribution of Topics by Dataset"</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">600</span>, <span class="fu">plotOutput</span>(<span class="st">"topic_distribution_plot"</span>, <span class="at">height =</span> <span class="dv">550</span>))</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>                <span class="fu">fluidRow</span>(</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">box</span>(<span class="at">title =</span> <span class="st">"Sentiment Distribution"</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">600</span>, <span class="fu">plotOutput</span>(<span class="st">"sentiment_distribution_plot"</span>, <span class="at">height =</span> <span class="dv">550</span>)),</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">box</span>(<span class="at">title =</span> <span class="st">"Travel Destination Frequency"</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">600</span>, <span class="fu">plotOutput</span>(<span class="st">"travel_frequency_plot"</span>, <span class="at">height =</span> <span class="dv">550</span>))</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tabItem</span>(<span class="at">tabName =</span> <span class="st">"dashboard"</span>,</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>              <span class="fu">fluidPage</span>(</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>                <span class="fu">h2</span>(<span class="st">"Dashboard"</span>),</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>                <span class="fu">fluidRow</span>(</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">column</span>(<span class="at">width =</span> <span class="dv">6</span>,</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">box</span>(<span class="at">title =</span> <span class="st">"Network Analysis of Members, Topics and Plans"</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">600</span>, <span class="fu">visNetworkOutput</span>(<span class="st">"network_plot"</span>, <span class="at">height =</span> <span class="dv">550</span>)),</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">box</span>(<span class="at">title =</span> <span class="st">"Geographic Analysis of Travel Patterns"</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">600</span>, <span class="fu">leafletOutput</span>(<span class="st">"map_plot"</span>, <span class="at">height =</span> <span class="dv">550</span>))</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>                  ),</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">column</span>(<span class="at">width =</span> <span class="dv">6</span>,</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">box</span>(<span class="at">title =</span> <span class="st">"Sentiment Heatmap by Member and Industry"</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">1200</span>, <span class="fu">plotOutput</span>(<span class="st">"heatmap_plot"</span>, <span class="at">height =</span> <span class="dv">1150</span>))</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>  combined_data <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req</span>(input<span class="sc">$</span>selected_datasets)</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(<span class="fu">lapply</span>(datasets[input<span class="sc">$</span>selected_datasets], <span class="cf">function</span>(d) {</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">nodes =</span> <span class="fu">as_tibble</span>(d<span class="sc">$</span>nodes), <span class="at">edges =</span> <span class="fu">as_tibble</span>(d<span class="sc">$</span>edges))</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>    }), <span class="at">.id =</span> <span class="st">"source"</span>)</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>industry_ui <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>    labels <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(datasets[input<span class="sc">$</span>selected_datasets], <span class="cf">function</span>(d) d<span class="sc">$</span>edges<span class="sc">$</span>label)))</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>    classified <span class="ot">&lt;-</span> <span class="fu">sapply</span>(labels, classify_industry_from_label)</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">checkboxGroupInput</span>(<span class="st">"industry_filter"</span>, <span class="st">"Industry - multi select:"</span>, <span class="at">choices =</span> <span class="fu">unique</span>(classified), <span class="at">selected =</span> <span class="fu">unique</span>(classified))</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>member_ui <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>    all_members <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(datasets[input<span class="sc">$</span>selected_datasets], <span class="cf">function</span>(d) {</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>      <span class="fu">unique</span>(d<span class="sc">$</span>nodes<span class="sc">$</span>name[d<span class="sc">$</span>nodes<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"entity.person"</span>])</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>    })))</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">selectInput</span>(<span class="st">"member_filter"</span>, <span class="st">"COOTFFOO Member - MULTI select:"</span>, <span class="at">choices =</span> all_members, <span class="at">selected =</span> all_members, <span class="at">multiple =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>network_plot <span class="ot">&lt;-</span> <span class="fu">renderVisNetwork</span>({</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">combined_data</span>()</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>    nodes <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="fu">lapply</span>(datasets[input<span class="sc">$</span>selected_datasets], <span class="cf">function</span>(d) <span class="fu">as_tibble</span>(d<span class="sc">$</span>nodes))) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>    edges <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="fu">lapply</span>(datasets[input<span class="sc">$</span>selected_datasets], <span class="cf">function</span>(d) <span class="fu">as_tibble</span>(d<span class="sc">$</span>edges)))</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(input<span class="sc">$</span>industry_filter)) {</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>      edges<span class="sc">$</span>industry_class <span class="ot">&lt;-</span> <span class="fu">sapply</span>(edges<span class="sc">$</span>label, classify_industry_from_label)</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>      edges <span class="ot">&lt;-</span> edges <span class="sc">%&gt;%</span> <span class="fu">filter</span>(industry_class <span class="sc">%in%</span> input<span class="sc">$</span>industry_filter <span class="sc">|</span> <span class="fu">is.na</span>(industry_class))</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(input<span class="sc">$</span>member_filter)) {</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>      nodes <span class="ot">&lt;-</span> nodes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(type <span class="sc">==</span> <span class="st">"entity.person"</span>) <span class="sc">|</span> name <span class="sc">%in%</span> input<span class="sc">$</span>member_filter)</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>    <span class="fu">visNetwork</span>(nodes, edges) <span class="sc">%&gt;%</span> <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>map_plot <span class="ot">&lt;-</span> <span class="fu">renderLeaflet</span>({</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">combined_data</span>()</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>    travel_places <span class="ot">&lt;-</span> data<span class="sc">$</span>nodes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"place"</span>)</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>    <span class="fu">leaflet</span>(travel_places) <span class="sc">%&gt;%</span></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addCircleMarkers</span>(<span class="sc">~</span>lon, <span class="sc">~</span>lat, <span class="at">label =</span> <span class="sc">~</span>label, <span class="at">radius =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">fillOpacity =</span> <span class="fl">0.7</span>)</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>heatmap_plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="fu">lapply</span>(datasets[input<span class="sc">$</span>selected_datasets], <span class="cf">function</span>(d) <span class="fu">as_tibble</span>(d<span class="sc">$</span>edges)))</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>    sentiment_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sentiment), <span class="sc">!</span><span class="fu">is.na</span>(label))</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>    sentiment_data<span class="sc">$</span>industry <span class="ot">&lt;-</span> <span class="fu">sapply</span>(sentiment_data<span class="sc">$</span>label, classify_industry_from_label)</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(input<span class="sc">$</span>industry_filter)) {</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>      sentiment_data <span class="ot">&lt;-</span> sentiment_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(industry <span class="sc">%in%</span> input<span class="sc">$</span>industry_filter)</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(sentiment_data, <span class="fu">aes</span>(<span class="at">x =</span> target, <span class="at">y =</span> industry, <span class="at">fill =</span> sentiment)) <span class="sc">+</span></span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Member"</span>, <span class="at">y =</span> <span class="st">"Industry"</span>, <span class="at">fill =</span> <span class="st">"Sentiment"</span>) <span class="sc">+</span></span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>participation_plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="fu">lapply</span>(datasets[input<span class="sc">$</span>selected_datasets], <span class="cf">function</span>(d) <span class="fu">as_tibble</span>(d<span class="sc">$</span>edges)), <span class="at">.id =</span> <span class="st">"dataset"</span>)</span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>    data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(source)) <span class="sc">%&gt;%</span></span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>      <span class="fu">count</span>(dataset, source) <span class="sc">%&gt;%</span></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> source, <span class="at">y =</span> n, <span class="at">fill =</span> dataset)) <span class="sc">+</span></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Member Participation Count"</span>, <span class="at">x =</span> <span class="st">"Member"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>topic_distribution_plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="fu">lapply</span>(datasets[input<span class="sc">$</span>selected_datasets], <span class="cf">function</span>(d) <span class="fu">as_tibble</span>(d<span class="sc">$</span>edges)), <span class="at">.id =</span> <span class="st">"dataset"</span>)</span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>    data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"topic"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">industry =</span> <span class="fu">sapply</span>(label, classify_industry_from_label)) <span class="sc">%&gt;%</span></span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>      <span class="fu">count</span>(dataset, industry) <span class="sc">%&gt;%</span></span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> dataset, <span class="at">y =</span> n, <span class="at">fill =</span> industry)) <span class="sc">+</span></span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Topics Discussed by Industry"</span>, <span class="at">x =</span> <span class="st">"Dataset"</span>, <span class="at">y =</span> <span class="st">"Count"</span>)</span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>sentiment_distribution_plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="fu">lapply</span>(datasets[input<span class="sc">$</span>selected_datasets], <span class="cf">function</span>(d) <span class="fu">as_tibble</span>(d<span class="sc">$</span>edges)), <span class="at">.id =</span> <span class="st">"dataset"</span>)</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>    data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sentiment)) <span class="sc">%&gt;%</span></span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> dataset, <span class="at">fill =</span> sentiment)) <span class="sc">+</span></span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sentiment Distribution"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>, <span class="at">x =</span> <span class="st">"Dataset"</span>)</span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>travel_frequency_plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="fu">lapply</span>(datasets[input<span class="sc">$</span>selected_datasets], <span class="cf">function</span>(d) <span class="fu">as_tibble</span>(d<span class="sc">$</span>edges)), <span class="at">.id =</span> <span class="st">"dataset"</span>)</span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>    data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Travel"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>      <span class="fu">count</span>(dataset, target) <span class="sc">%&gt;%</span></span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> target, <span class="at">y =</span> n, <span class="at">fill =</span> dataset)) <span class="sc">+</span></span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Travel Destination Frequency"</span>, <span class="at">x =</span> <span class="st">"Destination"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(ui, server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="dashboard-initial-data-analysis-insights" class="level2">
<h2 class="anchored" data-anchor-id="dashboard-initial-data-analysis-insights">Dashboard: Initial Data Analysis &amp; Insights</h2>
<p>This dashboard provides preliminary insights into the datasets provided by FILAH, TROUT, and JOURNALIST. The user starts by selecting datasets, industries, or specific COOTEFOO members. Four visualisations summarise:</p>
<ul>
<li><p><strong>Member Participation Count:</strong> Identifies active participants across datasets.</p></li>
<li><p><strong>Distribution of Topics by Dataset:</strong> Compares topic focus across sources</p></li>
<li><p><strong>Sentiment Distribution:</strong> Summarises sentiment polarity by industry.</p></li>
<li><p><strong>Travel Destination Frequency:</strong> Highlights common travel patterns and potential spatial biases.</p></li>
</ul>
<p>These visualisations collectively offer foundational context, highlighting gaps or biases before deeper analysis.</p>
<p><img src="images/clipboard-847572943.png" class="img-fluid"></p>
</section>
<section id="dashboard-main-integrated-analysis" class="level2">
<h2 class="anchored" data-anchor-id="dashboard-main-integrated-analysis">Dashboard: Main Integrated Analysis</h2>
<p>The main dashboard integrates sentiment, geographic, and network analysis, enabling an interactive exploration of the data:</p>
<ul>
<li><p>Sentiment Heatmap by Member and Industry: Clearly reveals biases or sentiment variations across datasets, identifying members with extreme or inconsistent stances.</p></li>
<li><p>Geographic Analysis of Travel Patterns: Shows interactive geographic clustering and frequency of travel, illustrating spatial biases towards fishing or tourism.</p></li>
<li><p>Network Analysis of Members, Topics, and Plans: Offers a detailed view of relationships and engagement across topics, pinpointing central figures and patterns of interactions.</p></li>
</ul>
<p>The coordinated interactivity across these panels supports detailed, multifaceted exploration to robustly assess and validate claims regarding COOTEFOO‚Äôs behaviours.</p>
<p><img src="images/clipboard-696956045.png" class="img-fluid"></p>
</section>
</section>
<section id="summary" class="level1">
<h1>Summary</h1>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Final Integrated Summary: Original (Quarto) vs New (Shiny)</caption>
<colgroup>
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 68%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Analytical Stage</th>
<th style="text-align: left;">Original Quarto Visualisation</th>
<th style="text-align: left;">Enhanced Shiny Interactive Visualisation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Initial Accusations (Engagement)</td>
<td style="text-align: left;">Static density/bar charts</td>
<td style="text-align: left;">Interactive node-link network and interactive bar/dot charts</td>
</tr>
<tr class="even">
<td style="text-align: left;">Spatial Bias (Travel Patterns)</td>
<td style="text-align: left;">Static jitter/network plots</td>
<td style="text-align: left;">Interactive leaflet map with clustering, filters and interactive trip counts</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sentiment Analysis</td>
<td style="text-align: left;">Single static heatmap</td>
<td style="text-align: left;">Interactive triple-panel heatmaps with drill-down comments and delta sentiment measures</td>
</tr>
<tr class="even">
<td style="text-align: left;">Integrated Personal Analysis</td>
<td style="text-align: left;">Single static ego network (Seal)</td>
<td style="text-align: left;">Fully integrated interactive dashboard (network, map, sentiment heat-bar, detailed evidence tables), explicitly illustrating bias distortions</td>
</tr>
</tbody>
</table>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>